{"paragraphs":[{"title":"","text":"import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.types._\n::\nval schemaStruct =\n        StructType(\n                    //StructField(\"LAB_0001\",StringType,false) ::\n                    //StructField( \"LAB_0002\",StringType,false) ::\n                    //StructField( \"LAB_0003\",StringType,false) ::\n                    //StructField( \"LAB_0004\",StringType,false) ::\n                    StructField( \"LAB_0005\",StringType,false) :: \n                    StructField( \"VAR_0001\",DoubleType,false) ::\n                    StructField( \"VAR_0002\",DoubleType,false) ::\n                    StructField( \"VAR_0003\",DoubleType,false) ::\n                    StructField( \"VAR_0004\",IntegerType,false):: \n                    StructField( \"VAR_0005\",IntegerType,false) ::\n                    StructField( \"VAR_0006\",DoubleType,false) ::\n                    StructField( \"VAR_0007\",DoubleType,false) ::\n                    StructField( \"VAR_0008\",DoubleType,false) ::\n                    StructField( \"VAR_0009\",DoubleType,false):: \n                    StructField( \"VAR_0010\",DoubleType,false) ::\n                    StructField( \"VAR_0011\",DoubleType,false) ::\n                    StructField( \"VAR_0012\",DoubleType,false):: \n                    StructField( \"VAR_0013\",DoubleType,false)::\n                    StructField( \"VAR_0014\",DoubleType,false) ::\n                    StructField( \"VAR_0015\",DoubleType,false) ::\n                    StructField( \"VAR_0016\",DoubleType,false) ::\n                    StructField( \"VAR_0017\",DoubleType,false) ::\n                    StructField( \"VAR_0018\",DoubleType,false) ::\n                    StructField( \"VAR_0019\",DoubleType,false) ::\n                    StructField( \"VAR_0020\",DoubleType,false) ::\n                    StructField( \"VAR_0021\",DoubleType,true) ::Nil)\n                    \nval df_001 = spark.\n                    read.\n                    schema(schemaStruct).\n                    option(\"header\", \"true\").\n                    option(\"sep\", \",\").\n                    csv(\"/data/iner/analytics/R007_DIA_ONR/onr/1_Modelo_Documentos/Data_caso_de_uso_1_entrenam.csv\").\n                    withColumn(\"LAB_0006\",when($\"LAB_0005\"===\"1\",\"true\").otherwise(\"false\"))\n                    \n","user":"rhinostrozap","dateUpdated":"2023-10-04T18:10:04-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.types._\nres0: collection.immutable.::.type = ::\nschemaStruct: org.apache.spark.sql.types.StructType = StructType(StructField(LAB_0001,StringType,false), StructField(LAB_0002,StringType,false), StructField(LAB_0003,StringType,false), StructField(LAB_0004,StringType,false), StructField(LAB_0005,StringType,false), StructField(VAR_0001,DoubleType,false), StructField(VAR_0002,DoubleType,false), StructField(VAR_0003,DoubleType,false), StructField(VAR_0004,IntegerType,false), StructField(VAR_0005,IntegerType,false), StructField(VAR_0006,DoubleType,false), StructField(VAR_0007,DoubleType,false), StructField(VAR_0008,DoubleType,false), StructField(VAR_0009,DoubleType,false), StructField(VAR_0010,DoubleType,false), StructField(VAR_0011,DoubleType,false), StructField(VAR_0012,DoubleType,false), StructField(VAR_0013,DoubleType,false), StructFiel...df_001: org.apache.spark.sql.DataFrame = [LAB_0001: string, LAB_0002: string ... 25 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842051_-1298590204","id":"20211228-104530_63735432","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:11:53-0500","dateFinished":"2023-10-04T09:12:23-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:313"},{"title":"","text":"val df_002 = df_001.select(\ntrim($\"LAB_0005\").alias(\"LAB_0005\"),\ntrim($\"VAR_0006\").alias(\"VAR_0006\").cast(\"integer\"),\ntrim($\"VAR_0016\").alias(\"VAR_0016\").cast(\"double\"),\ntrim($\"VAR_0019\").alias(\"VAR_0019\").cast(\"double\"),\ntrim($\"VAR_0011\").alias(\"VAR_0011\").cast(\"integer\"),\ntrim($\"VAR_0012\").alias(\"VAR_0012\").cast(\"double\"),\ntrim($\"VAR_0013\").alias(\"VAR_0013\").cast(\"double\"),\ntrim($\"VAR_0003\").alias(\"VAR_0003\").cast(\"integer\"),\ntrim($\"VAR_0007\").alias(\"VAR_0007\").cast(\"integer\"),\ntrim($\"VAR_0020\").alias(\"VAR_0020\").cast(\"double\"),\ntrim($\"VAR_0015\").alias(\"VAR_0015\").cast(\"double\"),\ntrim($\"VAR_0008\").alias(\"VAR_0008\").cast(\"integer\"),\ntrim($\"VAR_0018\").alias(\"VAR_0018\").cast(\"integer\"),\ntrim($\"VAR_0001\").alias(\"VAR_0001\").cast(\"integer\"),\ntrim($\"VAR_0002\").alias(\"VAR_0002\").cast(\"integer\"),\ntrim($\"VAR_0004\").alias(\"VAR_0004\"),\ntrim($\"LAB_0006\").alias(\"LAB_0006\"))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:12:36-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_002: org.apache.spark.sql.DataFrame = [LAB_0005: string, VAR_0006: int ... 15 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842309_1515093701","id":"20211227-152518_572162774","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:12:36-0500","dateFinished":"2023-10-04T09:12:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:314"},{"title":"","text":"import org.apache.spark.ml.feature.{StringIndexer}\n\nval labelIndexer = new StringIndexer().\n        setInputCol(\"LAB_0006\").\n        setOutputCol(\"LAB_0006_index\").\n        setStringOrderType(\"frequencyAsc\").\n        fit(df_002)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:12:48-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.StringIndexer\nlabelIndexer: org.apache.spark.ml.feature.StringIndexerModel = strIdx_ae9e2782eaf2"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842584_114378945","id":"20211227-155144_1891095019","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:12:48-0500","dateFinished":"2023-10-04T09:13:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:315"},{"title":"","text":"import org.apache.spark.ml.feature.OneHotEncoder;\n\nval indicadorIndexer = new StringIndexer().\n        setInputCol(\"VAR_0004\").\n        setOutputCol(\"VAR_0004\" + \"_index\").\n        setHandleInvalid(\"skip\").\n        fit(df_001)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:03-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.OneHotEncoder\nindicadorIndexer: org.apache.spark.ml.feature.StringIndexerModel = strIdx_41086a3f2ff8"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842639_-885661645","id":"20211227-155305_1503474282","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:03-0500","dateFinished":"2023-10-04T09:13:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:316"},{"text":"import org.apache.spark.ml.feature.VectorAssembler\n\nval featuresAssembler = new VectorAssembler().\n                            setInputCols(Array(\"VAR_0006\", \"VAR_0016\", \"VAR_0019\", \"VAR_0011\", \"VAR_0012\", \"VAR_0013\", \"VAR_0003\", \"VAR_0007\", \"VAR_0020\", \"VAR_0015\", \"VAR_0008\", \"VAR_0018\", \"VAR_0001\", \"VAR_0002\",\"VAR_0004_index\")).\n                            setOutputCol(\"features\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:08-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\nfeaturesAssembler: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_156da19c5ad0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842694_910609290","id":"20211227-155424_1289250788","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:09-0500","dateFinished":"2023-10-04T09:13:10-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:317"},{"text":"import org.apache.spark.ml.feature.StandardScaler\nimport org.apache.spark.ml.feature.MinMaxScaler\nimport org.apache.spark.ml.linalg.Vectors\n\n\nval scaler = new MinMaxScaler().\n  setInputCol(\"features\").\n  setOutputCol(\"scaledFeatures\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:13-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.StandardScaler\nimport org.apache.spark.ml.feature.MinMaxScaler\nimport org.apache.spark.ml.linalg.Vectors\nscaler: org.apache.spark.ml.feature.MinMaxScaler = minMaxScal_6eb27051ff09"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842751_-432813659","id":"20211227-155601_614116227","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:14-0500","dateFinished":"2023-10-04T09:13:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:318"},{"text":"import org.apache.spark.ml.classification.{LogisticRegression, LogisticRegressionModel}\n\nval lr = new LogisticRegression().\n        setLabelCol(\"LAB_0006_index\").\n        setFeaturesCol(\"scaledFeatures\").\n        setMaxIter(50).\n        setRegParam(0.05).\n        setElasticNetParam(0.01)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:23-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.classification.{LogisticRegression, LogisticRegressionModel}\nlr: org.apache.spark.ml.classification.LogisticRegression = logreg_479d834d99b8"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842833_1899441801","id":"20211227-160225_436479104","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:23-0500","dateFinished":"2023-10-04T09:13:24-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:319"},{"text":"import org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.tuning.{ParamGridBuilder,CrossValidator}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:29-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.ml.evaluation.BinaryClassificationEvaluator"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842888_1374052162","id":"20211228-233838_1941454497","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:29-0500","dateFinished":"2023-10-04T09:13:30-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:320"},{"text":"import org.apache.spark.ml.{Pipeline, PipelineModel}\n\nval pipeline = new Pipeline().setStages(Array(indicadorIndexer) ++ Array(featuresAssembler, scaler, labelIndexer, lr))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:43-0500","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.{Pipeline, PipelineModel}\npipeline: org.apache.spark.ml.Pipeline = pipeline_a6aa0a071f26"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340842947_-553723484","id":"20211227-160334_1817419175","dateCreated":"2023-10-03T08:47:22-0500","dateStarted":"2023-10-04T09:13:43-0500","dateFinished":"2023-10-04T09:13:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:321"},{"text":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nval evaluator = new BinaryClassificationEvaluator().\n    setLabelCol(\"LAB_0006_index\").\n    setRawPredictionCol(\"prediction\")\n  ","user":"rhinostrozap","dateUpdated":"2023-10-04T09:13:56-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nevaluator: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_deb8a2bc3fc9"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843236_734314529","id":"20211227-163357_712736998","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:13:56-0500","dateFinished":"2023-10-04T09:13:57-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:322"},{"text":"val Array(trainDF, testDF) = df_001.randomSplit(Array(0.65, 0.35), seed = 11L)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:14:10-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [LAB_0001: string, LAB_0002: string ... 25 more fields]\ntestDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [LAB_0001: string, LAB_0002: string ... 25 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843470_-531798774","id":"20211227-160758_555550983","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:14:10-0500","dateFinished":"2023-10-04T09:14:11-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:323"},{"text":"trainDF.count\ntrainDF.take(3)\n\ntestDF.count\ntestDF.take(3)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:14:27-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res9: Long = 688\nres10: Array[org.apache.spark.sql.Row] = Array([170023574350,10212532202,20600264908,201612,1,1.0,1.0,1.0,0,0,741.0,562.0,0.0,3.0,2.0,13.0,22.0,0.0,0.0,347180.0,0.53,0.0,0.0,775.0,828.333333333333,0.0,true], [170023574350,10212532202,20600284402,201612,1,0.0,0.0,0.0,0,0,750.0,573.0,0.0,2.0,4.0,34.0,22.0,0.0,0.0,20336.0,0.23,0.0,0.0,0.0,0.0,0.0,true], [170023574474,20521799120,10105835308,201612,0,0.0,0.0,0.0,0,0,2585.0,2585.0,2.0,0.0,4.0,550.0,23.0,0.0,0.0,15816.0,0.03,0.0,0.0,0.0,0.0,0.0,false])\nres12: Long = 347\nres13: Array[org.apache.spark.sql.Row] = Array([170023574360,20600594011,20562794078,201612,0,1.0,2.0,1.0,1,0,429.0,1164.0,2.0,0.0,1.0,1.0,17.0,0.0487804878048781,3907.0,225627.0,0.37,0.0,0.0,1443.35714285714,1699.44444444444,0.0,false], [170023574360,20600594011,20563303647,201612,0,1.0,2.0,1.0,1,0,394.0,57.0,2.0,0.0,2.0,2.0,17.0,0.0487804878048781,8401.0,319379.0,0.87,0.0,0.0,1568.63636363636,1916.73076923077,0.0,false], [170023580076,20553519536,10099045375,201612,0,1.0,1.0,1.0,0,0,767.0,568.0,1.0,0.0,3.0,39.0,13.0,0.0,0.0,9046.0,0.0,0.0,0.0,832.8,832.8,9067.5,false])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843533_-1909070153","id":"20211227-160855_824676369","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:14:27-0500","dateFinished":"2023-10-04T09:14:30-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:324"},{"text":"\n\nval model_lr = pipeline.fit(trainDF)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:14:39-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":4,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_lr: org.apache.spark.ml.PipelineModel = pipeline_a6aa0a071f26"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843617_-1941997876","id":"20211227-160920_1530260428","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:14:39-0500","dateFinished":"2023-10-04T09:14:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:325"},{"title":"","text":"model_lr.write.overwrite().save(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_lr\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:14:52-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843744_-838649927","id":"20211227-171108_225546583","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:14:52-0500","dateFinished":"2023-10-04T09:15:02-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:326"},{"title":"","text":"val predictions=model_lr.transform(testDF)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:15:12-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions: org.apache.spark.sql.DataFrame = [LAB_0001: string, LAB_0002: string ... 32 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843798_2062145052","id":"20211227-164425_1321269016","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:15:12-0500","dateFinished":"2023-10-04T09:15:13-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:327"},{"text":"predictions.columns\npredictions.head","user":"rhinostrozap","dateUpdated":"2023-10-03T17:20:45-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res32: Array[String] = Array(LAB_0001, LAB_0002, LAB_0003, LAB_0004, LAB_0005, VAR_0001, VAR_0002, VAR_0003, VAR_0004, VAR_0005, VAR_0006, VAR_0007, VAR_0008, VAR_0009, VAR_0010, VAR_0011, VAR_0012, VAR_0013, VAR_0014, VAR_0015, VAR_0016, VAR_0017, VAR_0018, VAR_0019, VAR_0020, VAR_0021, LAB_0006, VAR_0004_index, features, scaledFeatures, LAB_0006_index, rawPrediction, probability, prediction)\nres33: org.apache.spark.sql.Row = [170023574360,20600594011,20562794078,201612,0,1.0,2.0,1.0,1,0,429.0,1164.0,2.0,0.0,1.0,1.0,17.0,0.0487804878048781,3907.0,225627.0,0.37,0.0,0.0,1443.35714285714,1699.44444444444,0.0,false,0.0,[429.0,0.37,1443.35714285714,1.0,17.0,0.0487804878048781,1.0,1164.0,1699.44444444444,225627.0,2.0,0.0,1.0,2.0,0.0],[0.04713881019830028,0.37,0.055146797954271194,7.215007215007215E-4,0.45714285714285713,0.11764705882352965,0.3333333333333333,0.1453002122082137,0.011372743332741311,0.05021140343439617,0.125,0.0,0.3333333333333333,0.6666666666666666,0.0],0.0,[0.043740650869471986,-0.043740650869471986],[0.510933419580843,0.4890665804191569],0.0]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_0089<br/>Spark WebUI: <a href=\"null\">null</a>"}]},"apps":[],"jobName":"paragraph_1696340843854_380707245","id":"20211227-165635_1004154516","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-03T17:20:46-0500","dateFinished":"2023-10-03T17:20:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:328"},{"title":"","text":"predictions.stat.crosstab(\"LAB_0006_index\",\"prediction\").show()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:15:30-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+---+---+\n|LAB_0006_index_prediction|0.0|1.0|\n+-------------------------+---+---+\n|                      1.0| 51|123|\n|                      0.0|110| 63|\n+-------------------------+---+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340843908_2048459182","id":"20211227-165533_2138011798","dateCreated":"2023-10-03T08:47:23-0500","dateStarted":"2023-10-04T09:15:30-0500","dateFinished":"2023-10-04T09:15:38-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:329"},{"text":"val predictionAndLabels = predictions.\r\n    select(\"prediction\", \"LAB_0006_index\").\r\n    rdd.map(x => (x(0).asInstanceOf[Double], x(1).\r\n    asInstanceOf[Double]))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:15:43-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictionAndLabels: org.apache.spark.rdd.RDD[(Double, Double)] = MapPartitionsRDD[152] at map at <console>:44"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844046_1023311173","id":"20211227-164605_539713067","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:15:44-0500","dateFinished":"2023-10-04T09:15:45-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:330"},{"text":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\r\nval metrics = new BinaryClassificationMetrics(predictionAndLabels)\r\n   \r\nval areaUnderPR = metrics.areaUnderPR\r\nprintln(\"Area under the precision-recall curve: \" + areaUnderPR)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:15:47-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nmetrics: org.apache.spark.mllib.evaluation.BinaryClassificationMetrics = org.apache.spark.mllib.evaluation.BinaryClassificationMetrics@3b2b9d4b\nareaUnderPR: Double = 0.6378641173510111\nArea under the precision-recall curve: 0.6378641173510111"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844098_-685366129","id":"20211227-165302_1033675238","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:15:48-0500","dateFinished":"2023-10-04T09:15:56-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"val areaUnderROC = metrics.areaUnderROC\r\nprintln(\"Area under the receiver operating characteristic (ROC) curve: \" + areaUnderROC)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:16:02-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaUnderROC: Double = 0.6713673510065776\nArea under the receiver operating characteristic (ROC) curve: 0.6713673510065776"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844168_948364724","id":"20211228-091822_1958377002","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:16:03-0500","dateFinished":"2023-10-04T09:16:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"val lp = predictions.select(\"LAB_0006_index\", \"prediction\")\r\nval counttotal = predictions.count()\r\nval correct = lp.filter($\"LAB_0006_index\" === $\"prediction\").count()\r\nval wrong = lp.filter(not($\"LAB_0006_index\" === $\"prediction\")).count()\r\nval ratioWrong = wrong.toDouble / counttotal.toDouble\r\nval ratioCorrect = correct.toDouble / counttotal.toDouble\r\nval truep = lp.filter($\"prediction\" === 0.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal.toDouble\r\nval truen = lp.filter($\"prediction\" === 1.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal.toDouble\r\nval falsep = lp.filter($\"prediction\" === 1.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal.toDouble\r\nval falsen = lp.filter($\"prediction\" === 0.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal.toDouble\r\n\r\nprintln(\"Total Count: \" + counttotal)\r\nprintln(\"Correct: \" + correct)\r\nprintln(\"Wrong: \" + wrong)\r\nprintln(\"Ratio wrong: \" + ratioWrong)\r\nprintln(\"Ratio correct: \" + ratioCorrect)\r\nprintln(\"Ratio true positive: \" + truep)\r\nprintln(\"Ratio false positive: \" + falsep)\r\nprintln(\"Ratio true negative: \" + truen)\r\nprintln(\"Ratio false negative: \" + falsen)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:16:28-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.DataFrame = [LAB_0006_index: double, prediction: double]\ncounttotal: Long = 347\ncorrect: Long = 233\nwrong: Long = 114\nratioWrong: Double = 0.3285302593659942\nratioCorrect: Double = 0.6714697406340058\ntruep: Double = 0.3170028818443804\ntruen: Double = 0.35446685878962536\nfalsep: Double = 0.18155619596541786\nfalsen: Double = 0.14697406340057637\nTotal Count: 347\nCorrect: 233\nWrong: 114\nRatio wrong: 0.3285302593659942\nRatio correct: 0.6714697406340058\nRatio true positive: 0.3170028818443804\nRatio false positive: 0.18155619596541786\nRatio true negative: 0.35446685878962536\nRatio false negative: 0.14697406340057637"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844248_1771419260","id":"20211228-091909_1066853177","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:16:29-0500","dateFinished":"2023-10-04T09:16:40-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"val model_log=PipelineModel.load(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_lr\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:16:52-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_log: org.apache.spark.ml.PipelineModel = pipeline_a6aa0a071f26"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844299_1928033523","id":"20211228-094454_880898759","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:16:52-0500","dateFinished":"2023-10-04T09:17:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"val Predict_dataframe = model_log.transform(df_002)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:17:04-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Predict_dataframe: org.apache.spark.sql.DataFrame = [LAB_0005: string, VAR_0006: int ... 22 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844374_-1351000482","id":"20211227-161026_696740331","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:17:05-0500","dateFinished":"2023-10-04T09:17:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"Predict_dataframe.columns\nPredict_dataframe.head","user":"rhinostrozap","dateUpdated":"2023-10-03T17:21:47-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res49: Array[String] = Array(LAB_0005, VAR_0006, VAR_0016, VAR_0019, VAR_0011, VAR_0012, VAR_0013, VAR_0003, VAR_0007, VAR_0020, VAR_0015, VAR_0008, VAR_0018, VAR_0001, VAR_0002, VAR_0004, LAB_0006, VAR_0004_index, features, scaledFeatures, LAB_0006_index, rawPrediction, probability, prediction)\nres50: org.apache.spark.sql.Row = [0,7742,0.27,0.0,43,20.0,0.0714285714285714,0,7742,0.0,15588.0,0,0,0,0,0,false,1.0,(15,[0,1,3,4,5,7,9,14],[7742.0,0.27,43.0,20.0,0.0714285714285714,7742.0,15588.0,1.0]),[0.8758073654390934,0.27,0.0,0.031024531024531024,0.5428571428571428,0.1722689075630253,0.0,0.9664211708900262,0.0,0.0034689791413942813,0.0,0.0,0.0,0.0,1.0],0.0,[0.28713794619487554,-0.28713794619487554],[0.5712953108426775,0.42870468915732246],0.0]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_0089<br/>Spark WebUI: <a href=\"null\">null</a>"}]},"apps":[],"jobName":"paragraph_1696340844465_127330396","id":"20211227-161259_718768310","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-03T17:21:47-0500","dateFinished":"2023-10-03T17:21:48-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"Predict_dataframe.stat.crosstab(\"LAB_0006_index\",\"prediction\").show()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:17:23-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+---+---+\n|LAB_0006_index_prediction|0.0|1.0|\n+-------------------------+---+---+\n|                      1.0|146|388|\n|                      0.0|314|187|\n+-------------------------+---+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844656_419869738","id":"20211227-161230_1352416119","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:17:23-0500","dateFinished":"2023-10-04T09:17:29-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"val df_003 = df_001.select(\n    trim($\"LAB_0006\").alias(\"LAB_0006\"),\n    trim($\"VAR_0006\").alias(\"VAR_0006\").cast(\"integer\"),\n    trim($\"VAR_0016\").alias(\"VAR_0016\").cast(\"integer\"),\n    trim($\"VAR_0019\").alias(\"VAR_0019\").cast(\"double\"),\n    trim($\"VAR_0011\").alias(\"VAR_0011\"),\n    trim($\"VAR_0012\").alias(\"VAR_0012\").cast(\"double\"),\n    trim($\"VAR_0013\").alias(\"VAR_0013\").cast(\"double\"),\n    trim($\"VAR_0003\").alias(\"VAR_0003\").cast(\"integer\"),\n    trim($\"VAR_0007\").alias(\"VAR_0007\").cast(\"integer\"),\n    trim($\"VAR_0020\").alias(\"VAR_0020\").cast(\"double\"),\n    trim($\"VAR_0015\").alias(\"VAR_0015\").cast(\"double\"),\n    trim($\"VAR_0021\").alias(\"VAR_0021\").cast(\"double\"),\n    trim($\"VAR_0008\").alias(\"VAR_0008\").cast(\"integer\"),\n    trim($\"VAR_0010\").alias(\"VAR_0010\").cast(\"integer\"))\n","user":"rhinostrozap","dateUpdated":"2023-10-04T09:17:35-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df_003: org.apache.spark.sql.DataFrame = [LAB_0006: string, VAR_0006: int ... 12 more fields]"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844797_-129941768","id":"20211228-111257_456493703","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:17:35-0500","dateFinished":"2023-10-04T09:17:36-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"title":"","text":"val featuresAssembler_rf = new VectorAssembler().\n                            setInputCols(Array(\"VAR_0006\",\"VAR_0016\",\"VAR_0019\",\n                                                \"VAR_0011\",\"VAR_0012\",\"VAR_0013\",\n                                                \"VAR_0003\",\"VAR_0007\",\"VAR_0020\",\n                                                \"VAR_0015\",\"VAR_0021\",\"VAR_0008\",\"VAR_0010\")).\n                            setOutputCol(\"features\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:17:43-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"featuresAssembler_rf: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_94e57d7db540"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340844941_-1838354251","id":"20211228-113102_1799939462","dateCreated":"2023-10-03T08:47:24-0500","dateStarted":"2023-10-04T09:17:43-0500","dateFinished":"2023-10-04T09:17:44-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"title":"","text":"import org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\n\nval rf = new RandomForestClassifier().\n        setLabelCol(\"LAB_0006_index\").\n        setFeaturesCol(\"features\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:17:50-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.classification.{RandomForestClassificationModel, RandomForestClassifier}\nrf: org.apache.spark.ml.classification.RandomForestClassifier = rfc_f7f934bc600a"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845009_-1879921372","id":"20211228-113520_764711135","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:17:50-0500","dateFinished":"2023-10-04T09:17:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"import org.apache.spark.ml.{Pipeline, PipelineModel}\n\nval pipeline_rf = new Pipeline().setStages(Array(featuresAssembler_rf, labelIndexer, rf))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:18:02-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.{Pipeline, PipelineModel}\npipeline_rf: org.apache.spark.ml.Pipeline = pipeline_9b525203ecf7"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845160_767107466","id":"20211228-113817_67408900","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:18:03-0500","dateFinished":"2023-10-04T09:18:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"import org.apache.spark.ml.tuning.{ParamGridBuilder,CrossValidator}\nval paramGrid_rf= new ParamGridBuilder().\n    addGrid(rf.maxDepth, 3 :: 5 :: 15 :: 20 :: Nil).\n    addGrid(rf.featureSubsetStrategy, \"auto\"::\"all\"::Nil).\n    addGrid(rf.impurity,\"gini\"::\"entropy\"::Nil).\n    addGrid(rf.maxBins, 2 :: 5  :: 10 :: Nil).\n    addGrid(rf.numTrees, 10 :: 50  :: 100 :: Nil).\n    build()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:18:14-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nparamGrid_rf: Array[org.apache.spark.ml.param.ParamMap] =\nArray({\n\trfc_f7f934bc600a-featureSubsetStrategy: auto,\n\trfc_f7f934bc600a-impurity: gini,\n\trfc_f7f934bc600a-maxBins: 2,\n\trfc_f7f934bc600a-maxDepth: 3,\n\trfc_f7f934bc600a-numTrees: 10\n}, {\n\trfc_f7f934bc600a-featureSubsetStrategy: auto,\n\trfc_f7f934bc600a-impurity: gini,\n\trfc_f7f934bc600a-maxBins: 5,\n\trfc_f7f934bc600a-maxDepth: 3,\n\trfc_f7f934bc600a-numTrees: 10\n}, {\n\trfc_f7f934bc600a-featureSubsetStrategy: auto,\n\trfc_f7f934bc600a-impurity: gini,\n\trfc_f7f934bc600a-maxBins: 10,\n\trfc_f7f934bc600a-maxDepth: 3,\n\trfc_f7f934bc600a-numTrees: 10\n}, {\n\trfc_f7f934bc600a-featureSubsetStrategy: all,\n\trfc_f7f934bc600a-impurity: gini,\n\trfc_f7f934bc600a-maxBins: 2,\n\trfc_f7f934bc600a-maxDepth: 3,\n\trfc_f7f934bc600a-numTrees: 10\n}, {\n\trfc_f7f934bc600a-f..."},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845225_177210868","id":"20211228-121846_1075970256","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:18:14-0500","dateFinished":"2023-10-04T09:18:15-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nval evaluator_rf = new BinaryClassificationEvaluator().\n    setLabelCol(\"LAB_0006_index\").\n    setRawPredictionCol(\"prediction\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:18:26-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.evaluation.BinaryClassificationEvaluator\nevaluator_rf: org.apache.spark.ml.evaluation.BinaryClassificationEvaluator = binEval_386dd29c6279"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845295_-1781202131","id":"20211228-122357_1914863499","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:18:27-0500","dateFinished":"2023-10-04T09:18:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"val numFolds_rf =3\nval crossval_rf =new CrossValidator().\n    setEstimator(pipeline_rf).\n    setEvaluator(evaluator_rf).\n    setEstimatorParamMaps(paramGrid_rf).\n    setNumFolds(numFolds_rf)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:18:34-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"numFolds_rf: Int = 3\ncrossval_rf: org.apache.spark.ml.tuning.CrossValidator = cv_a3a85dc963c0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845367_1954885823","id":"20211228-122527_349165021","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:18:34-0500","dateFinished":"2023-10-04T09:18:35-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"val model_rf = pipeline_rf.fit(trainDF)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:18:39-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_rf: org.apache.spark.ml.PipelineModel = pipeline_9b525203ecf7"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845603_-1753914628","id":"20211228-113939_990016875","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:18:40-0500","dateFinished":"2023-10-04T09:19:00-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"model_rf.write.overwrite().save(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_rf\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:00-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845699_482552397","id":"20211228-114748_2057307231","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:23:00-0500","dateFinished":"2023-10-04T09:23:05-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"val model_rfw=PipelineModel.load(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_rf\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:17-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_rfw: org.apache.spark.ml.PipelineModel = pipeline_9b525203ecf7"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696370169782_-1320591703","id":"20231003-165609_318652954","dateCreated":"2023-10-03T16:56:09-0500","dateStarted":"2023-10-04T09:23:17-0500","dateFinished":"2023-10-04T09:23:20-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"val testPreds_rf = model_rf.transform(testDF)\ntestPreds_rf.columns\ntestPreds_rf.select(\"LAB_0006_index\", \"rawPrediction\", \"probability\", \"prediction\").take(3)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:24-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"testPreds_rf: org.apache.spark.sql.DataFrame = [LAB_0001: string, LAB_0002: string ... 30 more fields]\nres33: Array[String] = Array(LAB_0001, LAB_0002, LAB_0003, LAB_0004, LAB_0005, VAR_0001, VAR_0002, VAR_0003, VAR_0004, VAR_0005, VAR_0006, VAR_0007, VAR_0008, VAR_0009, VAR_0010, VAR_0011, VAR_0012, VAR_0013, VAR_0014, VAR_0015, VAR_0016, VAR_0017, VAR_0018, VAR_0019, VAR_0020, VAR_0021, LAB_0006, features, LAB_0006_index, rawPrediction, probability, prediction)\nres34: Array[org.apache.spark.sql.Row] = Array([0.0,[9.891222755626906,10.108777244373094],[0.4945611377813453,0.5054388622186547],1.0], [0.0,[8.849725408057408,11.15027459194259],[0.44248627040287036,0.5575137295971295],1.0], [0.0,[13.211371103301104,6.7886288966988975],[0.6605685551650552,0.33943144483494486],0.0])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845853_-295514195","id":"20211228-114300_2005950082","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:23:24-0500","dateFinished":"2023-10-04T09:23:25-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"testPreds_rf.stat.crosstab(\"LAB_0006_index\",\"prediction\").show()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:29-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+---+---+\n|LAB_0006_index_prediction|0.0|1.0|\n+-------------------------+---+---+\n|                      1.0| 44|130|\n|                      0.0|128| 45|\n+-------------------------+---+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845919_778739717","id":"20211228-114447_286690926","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:23:30-0500","dateFinished":"2023-10-04T09:23:33-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"val accuracy_rf=evaluator.evaluate(testPreds_rf)\nprintln(\"Clasificaion accuracy:\" + accuracy_rf)  ","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:36-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracy_rf: Double = 0.7435054149225966\nClasificaion accuracy:0.7435054149225966"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340845982_1922709913","id":"20211228-125200_92439016","dateCreated":"2023-10-03T08:47:25-0500","dateStarted":"2023-10-04T09:23:36-0500","dateFinished":"2023-10-04T09:23:37-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"val predictionAndLabels_rf = testPreds_rf.\r\n    select(\"prediction\", \"LAB_0006_index\").\r\n    rdd.map(x => (x(0).asInstanceOf[Double], x(1).\r\n    asInstanceOf[Double]))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:40-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictionAndLabels_rf: org.apache.spark.rdd.RDD[(Double, Double)] = MapPartitionsRDD[390] at map at <console>:50"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846042_-566321022","id":"20211228-125319_1851717489","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:23:40-0500","dateFinished":"2023-10-04T09:23:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\r\nval metrics_rf = new BinaryClassificationMetrics(predictionAndLabels_rf)\r\n   \r\nval areaUnderPR_rf = metrics_rf.areaUnderPR\r\nprintln(\"Area under the precision-recall curve: \" + areaUnderPR_rf)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:45-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nmetrics_rf: org.apache.spark.mllib.evaluation.BinaryClassificationMetrics = org.apache.spark.mllib.evaluation.BinaryClassificationMetrics@331ed5e\nareaUnderPR_rf: Double = 0.7123332528877595\nArea under the precision-recall curve: 0.7123332528877595"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846106_1792735415","id":"20211228-125322_132228310","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:23:45-0500","dateFinished":"2023-10-04T09:23:46-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"val areaUnderROC_rf = metrics_rf.areaUnderROC\r\nprintln(\"Area under the receiver operating characteristic (ROC) curve: \" + areaUnderROC_rf)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:50-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaUnderROC_rf: Double = 0.7435054149225966\nArea under the receiver operating characteristic (ROC) curve: 0.7435054149225966"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846160_1494250541","id":"20211228-125945_906041334","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:23:50-0500","dateFinished":"2023-10-04T09:23:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"val lp_rf = testPreds_rf.select(\"LAB_0006_index\", \"prediction\")\r\nval counttotal_rf = testPreds_rf.count()\r\nval correct_rf = lp_rf.filter($\"LAB_0006_index\" === $\"prediction\").count()\r\nval wrong_rf = lp_rf.filter(not($\"LAB_0006_index\" === $\"prediction\")).count()\r\nval ratioWrong_rf = wrong_rf.toDouble / counttotal_rf.toDouble\r\nval ratioCorrect_rf = correct_rf.toDouble / counttotal_rf.toDouble\r\nval truep_rf = lp_rf.filter($\"prediction\" === 0.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal_rf.toDouble\r\nval truen_rf = lp_rf.filter($\"prediction\" === 1.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal_rf.toDouble\r\nval falsep_rf = lp_rf.filter($\"prediction\" === 1.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal_rf.toDouble\r\nval falsen_rf = lp_rf.filter($\"prediction\" === 0.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal_rf.toDouble\r\n\r\nprintln(\"Total Count: \" + counttotal_rf)\r\nprintln(\"Correct: \" + correct_rf)\r\nprintln(\"Wrong: \" + wrong_rf)\r\nprintln(\"Ratio wrong: \" + ratioWrong_rf)\r\nprintln(\"Ratio correct: \" + ratioCorrect_rf)\r\nprintln(\"Ratio true positive: \" + truep_rf)\r\nprintln(\"Ratio false positive: \" + falsep_rf)\r\nprintln(\"Ratio true negative: \" + truen_rf)\r\nprintln(\"Ratio false negative: \" + falsen_rf)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:23:55-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp_rf: org.apache.spark.sql.DataFrame = [LAB_0006_index: double, prediction: double]\ncounttotal_rf: Long = 347\ncorrect_rf: Long = 258\nwrong_rf: Long = 89\nratioWrong_rf: Double = 0.2564841498559078\nratioCorrect_rf: Double = 0.7435158501440923\ntruep_rf: Double = 0.3688760806916426\ntruen_rf: Double = 0.3746397694524496\nfalsep_rf: Double = 0.12968299711815562\nfalsen_rf: Double = 0.12680115273775217\nTotal Count: 347\nCorrect: 258\nWrong: 89\nRatio wrong: 0.2564841498559078\nRatio correct: 0.7435158501440923\nRatio true positive: 0.3688760806916426\nRatio false positive: 0.12968299711815562\nRatio true negative: 0.3746397694524496\nRatio false negative: 0.12680115273775217"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846198_-967395161","id":"20211228-125943_1970110222","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:23:56-0500","dateFinished":"2023-10-04T09:24:02-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"val model_rf = crossval_rf.fit(trainDF)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:24:22-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_rf: org.apache.spark.ml.tuning.CrossValidatorModel = cv_a3a85dc963c0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696370995159_2078902948","id":"20231003-170955_2030624982","dateCreated":"2023-10-03T17:09:55-0500","dateStarted":"2023-10-04T09:24:23-0500","dateFinished":"2023-10-04T09:35:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"model_rf.write.overwrite().save(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_rf\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:18-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846237_-552733796","id":"20211228-130702_302020798","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:18-0500","dateFinished":"2023-10-04T09:35:20-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"import org.apache.spark.ml.tuning.CrossValidatorModel\nval modelrandomf = CrossValidatorModel.load(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_rf\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:30-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.tuning.CrossValidatorModel\nmodelrandomf: org.apache.spark.ml.tuning.CrossValidatorModel = cv_a3a85dc963c0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846275_590972543","id":"20211228-130700_782932575","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:30-0500","dateFinished":"2023-10-04T09:35:32-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"val testPreds_rfw = modelrandomf.transform(df_001)\ntestPreds_rfw.columns\ntestPreds_rfw.select(\"LAB_0006_index\", \"rawPrediction\", \"probability\", \"prediction\").take(3)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:34-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"testPreds_rfw: org.apache.spark.sql.DataFrame = [LAB_0001: string, LAB_0002: string ... 30 more fields]\nres51: Array[String] = Array(LAB_0001, LAB_0002, LAB_0003, LAB_0004, LAB_0005, VAR_0001, VAR_0002, VAR_0003, VAR_0004, VAR_0005, VAR_0006, VAR_0007, VAR_0008, VAR_0009, VAR_0010, VAR_0011, VAR_0012, VAR_0013, VAR_0014, VAR_0015, VAR_0016, VAR_0017, VAR_0018, VAR_0019, VAR_0020, VAR_0021, LAB_0006, features, LAB_0006_index, rawPrediction, probability, prediction)\nres52: Array[org.apache.spark.sql.Row] = Array([0.0,[7.0,3.0],[0.7,0.3],0.0], [0.0,[1.0,9.0],[0.1,0.9],1.0], [1.0,[0.0,10.0],[0.0,1.0],1.0])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846313_-800613293","id":"20211228-115134_392804127","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:34-0500","dateFinished":"2023-10-04T09:35:35-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"testPreds_rfw.stat.crosstab(\"LAB_0006_index\",\"prediction\").show()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:40-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+---+---+\n|LAB_0006_index_prediction|0.0|1.0|\n+-------------------------+---+---+\n|                      1.0| 72|462|\n|                      0.0|462| 39|\n+-------------------------+---+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846352_1871655185","id":"20211228-115207_1649679343","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:40-0500","dateFinished":"2023-10-04T09:35:41-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"import org.apache.spark.ml.feature.OneHotEncoder;\n\nval IndratcredIndexer = new StringIndexer().\n        setInputCol(\"VAR_0004\").\n        setOutputCol(\"VAR_0004\" + \"_index\").\n        setHandleInvalid(\"skip\").\n        fit(df_001)\n\nval ItancredIndexer = new StringIndexer().\n        setInputCol(\"VAR_0005\").\n        setOutputCol(\"VAR_0005\" + \"_index\").\n        setHandleInvalid(\"skip\").\n        fit(df_001)\n","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:45-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.OneHotEncoder\nIndratcredIndexer: org.apache.spark.ml.feature.StringIndexerModel = strIdx_be6693bd4fe2\nItancredIndexer: org.apache.spark.ml.feature.StringIndexerModel = strIdx_1618a66de163"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846480_2129160014","id":"20211228-165551_2124547140","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:45-0500","dateFinished":"2023-10-04T09:35:46-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"import org.apache.spark.ml.feature.VectorAssembler\n\nval featuresAssembler_gbt = new VectorAssembler().\n                            setInputCols(Array(\"VAR_0001\",\"VAR_0002\", \"VAR_0003\",\n                                                  \"VAR_0004\",  \"VAR_0005\",  \"VAR_0006\",\n                                                    \"VAR_0007\",  \"VAR_0008\",  \"VAR_0009\",\n                                                      \"VAR_0010\",  \"VAR_0011\",  \"VAR_0012\",\n                                                      \"VAR_0013\",  \"VAR_0014\",  \"VAR_0015\",  \"VAR_0016\",\n                                                        \"VAR_0018\",  \"VAR_0019\",\n                                                          \"VAR_0020\",  \"VAR_0021\")).\n                            setOutputCol(\"features\")","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:50-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.feature.VectorAssembler\nfeaturesAssembler_gbt: org.apache.spark.ml.feature.VectorAssembler = vecAssembler_8eac4cf17802"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846520_1653560918","id":"20211228-132639_1309027649","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:50-0500","dateFinished":"2023-10-04T09:35:51-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"import org.apache.spark.ml.classification.{GBTClassificationModel, GBTClassifier}\n\nval gbt = new GBTClassifier().\n        setLabelCol(\"LAB_0006_index\").\n        setFeaturesCol(\"features\").\n        setMaxIter(4). // number of trees, default is 20\n        setMaxDepth(3) // Default is 5 )The same as Random Forest)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:35:54-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.classification.{GBTClassificationModel, GBTClassifier}\ngbt: org.apache.spark.ml.classification.GBTClassifier = gbtc_2423bc573cc0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846562_-1646318546","id":"20211228-170537_2117827082","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:35:55-0500","dateFinished":"2023-10-04T09:35:56-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"import org.apache.spark.ml.{Pipeline, PipelineModel}\n\nval pipeline_gbt = new Pipeline().setStages(Array(featuresAssembler_gbt, labelIndexer, gbt))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:05-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.{Pipeline, PipelineModel}\npipeline_gbt: org.apache.spark.ml.Pipeline = pipeline_bc309d537a72"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846602_548895278","id":"20211228-170713_957378835","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:05-0500","dateFinished":"2023-10-04T09:36:06-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"val model_gbt = pipeline_gbt.fit(trainDF)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:13-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model_gbt: org.apache.spark.ml.PipelineModel = pipeline_bc309d537a72"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846641_994622247","id":"20211228-171151_1224309929","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:14-0500","dateFinished":"2023-10-04T09:36:16-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"val testPreds_gbt = model_gbt.transform(testDF)\n//testPreds_gbt.columns\ntestPreds_gbt.select(\"LAB_0006_index\", \"probability\", \"prediction\").take(3)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:29-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"testPreds_gbt: org.apache.spark.sql.DataFrame = [LAB_0001: string, LAB_0002: string ... 30 more fields]\nres60: Array[org.apache.spark.sql.Row] = Array([0.0,[0.5487938148125917,0.4512061851874083],0.0], [0.0,[0.2541665010657409,0.7458334989342591],1.0], [0.0,[0.5487938148125917,0.4512061851874083],0.0])"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846681_-6842015","id":"20211228-171147_431259053","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:29-0500","dateFinished":"2023-10-04T09:36:30-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"testPreds_gbt.stat.crosstab(\"LAB_0006_index\",\"prediction\").show()","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:41-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+---+---+\n|LAB_0006_index_prediction|0.0|1.0|\n+-------------------------+---+---+\n|                      1.0| 43|131|\n|                      0.0|120| 53|\n+-------------------------+---+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846733_-911596972","id":"20211228-171146_1982298697","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:41-0500","dateFinished":"2023-10-04T09:36:42-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"val accuracy_gbt=evaluator.evaluate(testPreds_gbt)\nprintln(\"Clasificaion accuracy:\" + accuracy_gbt)  //0.6884","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:46-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"accuracy_gbt: Double = 0.7232575908577503\nClasificaion accuracy:0.7232575908577503"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846771_365092612","id":"20211228-171743_901676225","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:46-0500","dateFinished":"2023-10-04T09:36:47-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"val predictionAndLabels_gbt = testPreds_gbt.\r\n    select(\"prediction\", \"LAB_0006_index\").\r\n    rdd.map(x => (x(0).asInstanceOf[Double], x(1).\r\n    asInstanceOf[Double]))","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:53-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictionAndLabels_gbt: org.apache.spark.rdd.RDD[(Double, Double)] = MapPartitionsRDD[27727] at map at <console>:57"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846808_-405039070","id":"20211228-171741_94195772","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:53-0500","dateFinished":"2023-10-04T09:36:54-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\r\nval metrics_gbt = new BinaryClassificationMetrics(predictionAndLabels_gbt)\r\n   \r\nval areaUnderPR_gbt = metrics_gbt.areaUnderPR\r\nprintln(\"Area under the precision-recall curve: \" + areaUnderPR_gbt)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:36:59-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.mllib.evaluation.BinaryClassificationMetrics\nmetrics_gbt: org.apache.spark.mllib.evaluation.BinaryClassificationMetrics = org.apache.spark.mllib.evaluation.BinaryClassificationMetrics@51aeb705\nareaUnderPR_gbt: Double = 0.6859445367373951\nArea under the precision-recall curve: 0.6859445367373951"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846843_-66967451","id":"20211228-172156_57840231","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:36:59-0500","dateFinished":"2023-10-04T09:37:00-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"val areaUnderROC_gbt = metrics_gbt.areaUnderROC\r\nprintln(\"Area under the receiver operating characteristic (ROC) curve: \" + areaUnderROC_gbt)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:37:03-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"areaUnderROC_gbt: Double = 0.7232575908577503\nArea under the receiver operating characteristic (ROC) curve: 0.7232575908577503"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846881_-332796474","id":"20211228-172254_403532515","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:37:03-0500","dateFinished":"2023-10-04T09:37:04-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"text":"val lp_gbt = testPreds_gbt.select(\"LAB_0006_index\", \"prediction\")\r\nval counttotal_gbt = testPreds_gbt.count()\r\nval correct_gbt = lp_gbt.filter($\"LAB_0006_index\" === $\"prediction\").count()\r\nval wrong_gbt = lp_gbt.filter(not($\"LAB_0006_index\" === $\"prediction\")).count()\r\nval ratioWrong_gbt = wrong_gbt.toDouble / counttotal_gbt.toDouble\r\nval ratioCorrect_gbt = correct_gbt.toDouble / counttotal_gbt.toDouble\r\nval truep_gbt = lp_gbt.filter($\"prediction\" === 0.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal_gbt.toDouble\r\nval truen_gbt = lp_gbt.filter($\"prediction\" === 1.0).filter($\"LAB_0006_index\" === $\"prediction\").count() / counttotal_gbt.toDouble\r\nval falsep_gbt = lp_gbt.filter($\"prediction\" === 1.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal_gbt.toDouble\r\nval falsen_gbt = lp_gbt.filter($\"prediction\" === 0.0).filter(not($\"LAB_0006_index\" === $\"prediction\")).count() / counttotal_gbt.toDouble\r\n\r\nprintln(\"Total Count: \" + counttotal_gbt)\r\nprintln(\"Correct: \" + correct_gbt)\r\nprintln(\"Wrong: \" + wrong_gbt)\r\nprintln(\"Ratio wrong: \" + ratioWrong_gbt)\r\nprintln(\"Ratio correct: \" + ratioCorrect_gbt)\r\nprintln(\"Ratio true positive: \" + truep_gbt)\r\nprintln(\"Ratio false positive: \" + falsep_gbt)\r\nprintln(\"Ratio true negative: \" + truen_gbt)\r\nprintln(\"Ratio false negative: \" + falsen_gbt)","user":"rhinostrozap","dateUpdated":"2023-10-04T09:37:08-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp_gbt: org.apache.spark.sql.DataFrame = [LAB_0006_index: double, prediction: double]\ncounttotal_gbt: Long = 347\ncorrect_gbt: Long = 251\nwrong_gbt: Long = 96\nratioWrong_gbt: Double = 0.276657060518732\nratioCorrect_gbt: Double = 0.723342939481268\ntruep_gbt: Double = 0.345821325648415\ntruen_gbt: Double = 0.37752161383285304\nfalsep_gbt: Double = 0.15273775216138327\nfalsen_gbt: Double = 0.1239193083573487\nTotal Count: 347\nCorrect: 251\nWrong: 96\nRatio wrong: 0.276657060518732\nRatio correct: 0.723342939481268\nRatio true positive: 0.345821325648415\nRatio false positive: 0.15273775216138327\nRatio true negative: 0.37752161383285304\nRatio false negative: 0.1239193083573487"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846919_-1097197210","id":"20211228-172416_617883819","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:37:08-0500","dateFinished":"2023-10-04T09:37:11-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:371"},{"text":"model_gbt.write.overwrite().save(\"/data/iner/analytics/landing_zone/ONR/modelos/mlogic.model_gbt\")","user":"rhinostrozap","dateUpdated":"2023-10-04T16:39:51-0500","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1696360225253_2143<br/>Spark WebUI: <a href=\"http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/\">http://S01PLXCHDP001.sunat.gob.pe:8088/proxy/application_1696360225253_2143/</a>"}]},"apps":[],"jobName":"paragraph_1696340846957_-1826987859","id":"20211228-172805_1343805733","dateCreated":"2023-10-03T08:47:26-0500","dateStarted":"2023-10-04T09:37:15-0500","dateFinished":"2023-10-04T09:37:17-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:372"}],"name":"INER/analytics/onr1/LandingZone_Entrenamiento","id":"2JBXGZGKC","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"iner_user:rhinostrozap:":[],"sh:rhinostrozap:":[],"jdbc:shared_process":[],"spark2:shared_process":[],"iner_note:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":true,"looknfeel":"default","personalizedMode":"false"},"info":{}}